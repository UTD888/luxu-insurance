
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LUXU POKER INSURANCE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    body {
      background-color: #1e1e1e;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }
    h1 {
      text-align: center;
      font-weight: 700;
      color: #f5c518;
      margin-bottom: 10px;
    }
    .card-slot, .player-card {
      background-color: #2c2c2c;
      background-image: url('https://raw.githubusercontent.com/UTD888/luxu-insurance/8b7891c71e3f2ac6cffb9545bed9ba6c2f7c2159/svg-cards/back.svg');
      background-size: 95%;
      background-position: center;
      background-repeat: no-repeat;
      cursor: pointer;
    }
    .card-slot {
      width: 84px;
      height: 126px;
      border: 2px dashed #555;
      margin: 4px;
    }
    .player-card {
      width: 68px;
      height: 101px;
      border: 2px dashed #555;
      margin: 4px;
    }
    .card-slot.active, .player-card.active {
      /* original active style */
    }
    .card-slot.has-card, .player-card.has-card {
      border: none;
      transform: scale(1.2);
      z-index: 5;
    }
    .card-slot, .player-card {
      transition: transform 0.2s ease;
    }
      border: 2px solid #0d6efd;
    }
    .player-box {
      background-color: #2b2b2b;
      padding: 8px;
      border-radius: 10px;
      text-align: center;
    }
    .player-row {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    .player-card-row {
      display: flex;
      justify-content: center;
      gap: 8px;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
    }
    .btn-icon {
      min-width: 140px;
    }
    .outs-box {
      background-color: #333;
      padding: 15px;
      border-radius: 10px;
      margin-top: 30px;
    }
    .reset-container {
      display: flex;
      justify-content: center;
      margin-bottom: 15px;
    }

    /* popup */
    #card-popup {
      position: fixed;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      background: #222;
      border: 2px solid #f5c518;
      padding: 10px;
      z-index: 1000;
      display: none;
      width: 90%;
      max-width: 360px;
    }
    .popup-tabs {
      display: flex;
      justify-content: space-around;
      margin-bottom: 10px;
    }
    .popup-tab {
      padding: 6px 12px;
      background: #444;
      color: white;
      cursor: pointer;
      border-radius: 6px;
    }
    .popup-tab.active {
      background: #f5c518;
      color: black;
      font-weight: bold;
    }
    .popup-grid {
      display: none;
      flex-wrap: wrap;
      gap: 5px;
      justify-content: center;
    }
    .popup-grid.active {
      display: flex;
    }
    .popup-card {
      width: 68px;
      height: 101px;
      background-size: cover;
      border: 1px solid #666;
      border-radius: 4px;
      cursor: pointer;
    }
    #popup-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 999;
    }
  </style>
</head>
<body>
  <h1>LUXU POKER INSURANCE</h1>

  <div class="reset-container">
    <button class="btn btn-danger btn-sm" onclick="resetAll()">
      <i class="bi bi-arrow-clockwise"></i> Reset
    </button>
  </div>

  <div class="text-center mb-4">
    <div class="d-flex justify-content-center flex-wrap">
      <div class="card-slot" id="board1" onclick="openPopup(this)"></div>
      <div class="card-slot" id="board2" onclick="openPopup(this)"></div>
      <div class="card-slot" id="board3" onclick="openPopup(this)"></div>
      <div class="card-slot" id="board4" onclick="openPopup(this)"></div>
    </div>
  </div>

  <div id="player-area" class="text-center">
    <div class="player-row" id="player-row">
      <div class="player-box" id="p1">
        <div><strong>P1</strong></div>
        <div class="player-card-row">
          <div class="player-card" id="p1c1" onclick="openPopup(this)"></div>
          <div class="player-card" id="p1c2" onclick="openPopup(this)"></div>
        </div>
      </div>
      <div class="player-box" id="p2">
        <div><strong>P2</strong></div>
        <div class="player-card-row">
          <div class="player-card" id="p2c1" onclick="openPopup(this)"></div>
          <div class="player-card" id="p2c2" onclick="openPopup(this)"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button class="btn btn-success btn-icon" id="add-player">
      <i class="bi bi-person-plus-fill"></i> เพิ่มผู้เล่น
    </button>
    <button class="btn btn-warning btn-icon" id="remove-player">
      <i class="bi bi-person-dash-fill"></i> ลบผู้เล่น
    </button>
  </div>

  <div class="outs-box text-center">
    <h5>Outs / Rate</h5>
    <div id="outs-result" style="white-space: pre-line;">ยังไม่มีข้อมูล</div>
  </div>

  <div id="popup-overlay" onclick="closePopup()"></div>
  <div id="card-popup"></div>

  <script>
    const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
    const ranks = ['2','3','4','5','6','7','8','9','10','jack','queen','king','ace'];
    const selectedCards = new Map();
    let activeElement = null;

    function openPopup(el) {
      activeElement = el;
      const popup = document.getElementById("card-popup");
      const overlay = document.getElementById("popup-overlay");
      popup.innerHTML = "";

      const tabContainer = document.createElement("div");
      tabContainer.className = "popup-tabs";

      const gridContainers = {};

      suits.forEach((suit, idx) => {
        const tab = document.createElement("div");
        tab.className = "popup-tab" + (idx === 0 ? " active" : "");
        tab.textContent = suit[0].toUpperCase() + suit.slice(1);
        tab.onclick = () => {
          document.querySelectorAll(".popup-tab").forEach(t => t.classList.remove("active"));
          document.querySelectorAll(".popup-grid").forEach(g => g.classList.remove("active"));
          tab.classList.add("active");
          gridContainers[suit].classList.add("active");
        };
        tabContainer.appendChild(tab);
      });

      popup.appendChild(tabContainer);

      suits.forEach((suit, idx) => {
        const grid = document.createElement("div");
        grid.className = "popup-grid" + (idx === 0 ? " active" : "");
        ranks.forEach(rank => {
          const name = `${rank}_of_${suit}`;
          if ([...selectedCards.values()].includes(name) && selectedCards.get(activeElement?.id) !== name) return;
          const card = document.createElement("div");
          card.className = "popup-card";
          card.style.backgroundImage = `url('https://raw.githubusercontent.com/UTD888/luxu-insurance/8b7891c71e3f2ac6cffb9545bed9ba6c2f7c2159/svg-cards/${name}.svg')`;
          card.onclick = () => {
            if (activeElement && activeElement.id) {
              const old = selectedCards.get(activeElement.id);
              if (old) selectedCards.forEach((v, k) => { if (v === old) selectedCards.delete(k); });
              selectedCards.set(activeElement.id, name);
              activeElement.style.backgroundImage = card.style.backgroundImage;
activeElement.classList.add('has-card');
              closePopup();
            }
          };
          grid.appendChild(card);
        });
        popup.appendChild(grid);
        gridContainers[suit] = grid;
      });

      popup.style.display = "block";
      overlay.style.display = "block";
    }

    function closePopup() {
      document.getElementById("card-popup").style.display = "none";
      document.getElementById("popup-overlay").style.display = "none";
      activeElement = null;
    }

    function resetAll() {
      selectedCards.clear();
      document.querySelectorAll(".card-slot, .player-card").forEach(card => {
        card.style.backgroundImage = "url('https://raw.githubusercontent.com/UTD888/luxu-insurance/8b7891c71e3f2ac6cffb9545bed9ba6c2f7c2159/svg-cards/back.svg')";
card.classList.remove('has-card');
      });
    }
  </script>
</body>
</html>
